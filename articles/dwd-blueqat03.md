---
title: "Blueqat ã§éŠã‚“ã§ã¿ã‚‹ (3) â€” Barren Plateau è«–æ–‡ã‚’çœºã‚ã‚‹"
emoji: "ğŸ±"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["blueqat", "Qiskit", "é‡å­ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿", "ãƒã‚¨ãƒ ", "Python"]
published: false
---

# ç›®çš„

ã“ã®è¨˜äº‹ã§ã¯ Barren Plateau ã®è«–æ–‡ã«ã¤ã„ã¦ã–ã£ã¨çœºã‚ãŸä¸Šã§ç°¡å˜ãªæ¤œè¨¼ç”¨ã®å›è·¯ã‚’å®Ÿè£…ãŠã‚ˆã³å®Ÿè¡Œã—ã¦æ§˜å­ã‚’è¦‹ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚è«–æ–‡ã«ã¤ã„ã¦ã¯å„ç¨®å‹‰å¼·ä¼šã§èã„ãŸã‚‚ã®ã‚’ä¸­å¿ƒã«çœºã‚ã¾ã™ãŒã€å¹¾ã‚‰ã‹èˆˆå‘³ã§è¿½åŠ ã—ã¦ã„ã¾ã™ã€‚

æ¤œè¨¼ã«ã¯ [blueqat SDK](https://github.com/Blueqat/Blueqat) ã‚’ç”¨ã„ã¾ã™ãŒã€å®Ÿé¨“çš„ã« [cuStateVec](https://docs.nvidia.com/cuda/cuquantum/custatevec/) ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’ç”¨ã„ã¦ã¿ã¾ã™ã€‚æã‚‰ãå¤§è¢ˆè£Ÿã™ãã‚‹å®Ÿè£…ãªã®ã§ã€`numpy` ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§è‰¯ã„ã¨ã¯æ€ã„ã¾ã™ã€‚

å®Ÿé¨“ç’°å¢ƒã¯ Google Colab ã¨ã—ã¾ã—ãŸã€‚æœ€è¿‘ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãŒ Python 3.8 ã«ãªã‚Šã¾ã—ãŸã®ã§ã€[cuquantum-python](https://pypi.org/project/cuquantum-python/) ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚‚æ¥½ã«ãªã‚Šã¾ã—ãŸã€‚

# Barren Plateau ã¨ã¯

ã¾ãšã€Barren Plateau ã«ã¤ã„ã¦æ¦‚è¦ã‚’è¦‹ã¦ã¿ã¾ã™ã€‚å‚è€ƒæ–‡çŒ®ã‚’å…¨èˆ¬ã«çœºã‚ãŸä¸Šã§ã®ã¾ã¨ã‚ã§ã™ã®ã§ã€ã‚„ã‚„åºƒç¯„ãªè¨˜è¿°ã«ãªã£ã¦ã„ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

- ã‚³ã‚¹ãƒˆé–¢æ•°ã®å‹¾é…ãŒæŒ‡æ•°é–¢æ•°çš„ã«æŠ‘åˆ¶ã•ã‚Œã¦ã—ã¾ã„è¨“ç·´ãŒé€²ã¾ãªã„ã€æˆ–ã„ã¯é€²ã‚ã‚ˆã†ã¨ã™ã‚‹ã¨æŒ‡æ•°é–¢æ•°çš„ãªã‚·ãƒ§ãƒƒãƒˆæ•°ã§æ¸¬å®šã—ã¦ã€æŒ‡æ•°é–¢æ•°çš„ç²¾åº¦ã§å‹¾é…ã‚’æ±‚ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹ã‚ˆã†ãªå•é¡Œç¾è±¡å…¨èˆ¬ã‚’ **Barren Plateau (ä¸æ¯›ã®å°åœ°)** ã¨å‘¼ã¶ã€‚
- æµ…ã„é‡å­å›è·¯ã¨æ·±ã„é‡å­å›è·¯ã®ä¸¡æ–¹ã§èµ·ã“ã‚Šå¾—ã‚‹ã€‚å•é¡Œã«ã¤ãªãŒã‚‹åŸå› ã¯ã„ãã¤ã‹å­˜åœ¨ã™ã‚‹ã€‚
    - ä¾‹ãˆã°ã€é‡å­ãƒ“ãƒƒãƒˆæ•°ã«å¯¾ã—ã¦æŒ‡æ•°é–¢æ•°çš„ãªå‹¾é…æŠ‘åˆ¶ãŒç™ºç”Ÿã™ã‚‹ã‚±ãƒ¼ã‚¹ãŒã‚ã‚‹ã€‚
- ã‚³ã‚¹ãƒˆé–¢æ•°ã®é›¢ã‚ŒãŸ 2 ç‚¹é–“ã®å·®ã§ã‚‚æŒ‡æ•°é–¢æ•°çš„æŠ‘åˆ¶ãŒã¯ãŸã‚‰ãå¾—ã‚‹ã€‚
    ã‚ˆã£ã¦ã€å‹¾é…ã‚’ä½¿ã‚ãªã„æœ€é©åŒ–ã§ã‚‚ Barren Plateau ã‚’å›é¿ã—ãŸè¨“ç·´ãŒã§ãã‚‹ã¨ã¯è¨€ãˆãªã„ã€‚
- QCNN ã‚„å±€æ‰€ãƒãƒŸãƒ«ãƒˆãƒ‹ã‚¢ãƒ³ã¨ã„ã£ãŸç‰¹åˆ¥ãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ä¸­ã«ã¯å‹¾é…æŠ‘åˆ¶ãŒå¤šé …å¼çš„ã«ãªã‚Š Barren Plateau ã‚’å›é¿ã§ãã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã‚‚ã®ãŒã‚ã‚‹ã€‚
- FTQC (éšœå®³è€æ€§é‡å­ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿) ã§ã‚‚è€ƒãˆã‚‰ã‚Œã‚‹ç†è«–çš„ãª Barren Plateau ã«åŠ ãˆã€NISQ ãªã‚‰ã§ã¯ã®ãƒã‚¤ã‚ºã«èµ·å› ã™ã‚‹ Barren Plateau ã‚‚ã‚ã‚‹ã€‚

æ—¥æœ¬èªã§èª­ã‚ã‚‹æ°—æ¥½ãªè³‡æ–™ã¨ã—ã¦ã¯æ–‡çŒ® [1] Qiskit textbook ãŒè©²å½“ã™ã‚‹ã¨æ€ã„ã¾ã™ã€‚ã€Œå¤‰åˆ†è¨“ç·´ã€ã®ã¨ã“ã‚ã§èª¬æ˜ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã«ã€æå¤±é–¢æ•°ã®ãƒ©ãƒ³ãƒ‰ã‚¹ã‚±ãƒ¼ãƒ—å†…ã«å°åœ°ã®ã‚ˆã†ãªå¹³å¦ãªå½¢çŠ¶ãŒå‡ºã¦ãã¦ã€æœ€é©åŒ–è¨ˆç®—ãŒé€²ã¾ãªã„ã¨ã„ã†ã“ã¨ã§ã™ã€‚åŒæ–‡çŒ®ã®è§£èª¬ã¯åŸºæœ¬çš„ã«æ–‡çŒ® [2] _Barren plateaus in quantum neural network training landscapes_ ã®ã‚‚ã®ã§ã™ãŒã€ãã‚Œã‹ã‚‰è‰²ã€…ãªã“ã¨ãŒåˆ†ã‹ã£ã¦ãã¾ã—ãŸã€‚

# Barren Plateau ã® 3 åˆ†æ•°ç†

**å‹¾é…ãŒæŒ‡æ•°é–¢æ•°çš„ã«æŠ‘åˆ¶** ã®ãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹ãŒåˆ†ã‹ã‚Šã«ãã„ã®ã§ã€è«–æ–‡ [10] _Effect of barren plateaus on gradient-free optimization_ ã‚’å‚è€ƒã«ã©ã†ã„ã†ã‚‚ã®ã‹ã‚’æ•°å¼ã§æ›¸ãä¸‹ã—ã¦ã¿ã¾ã™ã€‚

ã‚³ã‚¹ãƒˆé–¢æ•° (ä¾‹ãˆã°ãƒãƒŸãƒ«ãƒˆãƒ‹ã‚¢ãƒ³ã®æœŸå¾…å€¤) ã‚’

$$
\begin{align*}
C(\bm{\theta}) = \sum_{x=1}^{S} f_x(\bm{\theta}, \rho_x)
\end{align*}
$$

ã¨ã—ã¾ã™ã€‚è¨˜å·ã®æ„å‘³ã«ã¤ã„ã¦ã¯è«–æ–‡ [10] ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## å®šç¾© (Barren Plateau)

ã™ã¹ã¦ã® $\theta_\mu \in \bm{\theta}$ ã«å¯¾ã—ã¦ã‚³ã‚¹ãƒˆé–¢æ•°ã®å¾®åˆ†ã®æœŸå¾…å€¤ãŒ 0ã€å³ã¡

$$
\begin{align*}
E_{\bm{\theta}}[\partial_\mu C(\bm{\theta})] = 0
\end{align*}
$$

ã§ã‚ã£ã¦ã€ã‚³ã‚¹ãƒˆé–¢æ•°ã®å¾®åˆ†ã®åˆ†æ•£ãŒé‡å­ãƒ“ãƒƒãƒˆæ•° $n$ ã«é–¢ã—ã¦æŒ‡æ•°é–¢æ•°çš„ã«æ¸›å°‘ã™ã‚‹ã€å³ã¡é©å½“ãª $b > 1$ ã«å¯¾ã—ã¦

$$
\begin{align*}
\mathrm{Var}_{\bm{\theta}}[\partial_\mu C(\bm{\theta})] \leq F(n),\quad\quad F(n) \in \mathcal{O}\left( \frac{1}{b^n} \right)
\end{align*}
$$

ã‚’æº€ãŸã™æ™‚ã€ã‚³ã‚¹ãƒˆé–¢æ•° $C$ ã¯ Barren Plateau ã‚’å‘ˆã™ã‚‹ã¨è¨€ã†ã€‚â€”â€”â€”

è¦ã™ã‚‹ã«ã€å‹¾é…ã®å¾®åˆ†ãŒå°ã•ã„ä¸Šã«ã°ã‚‰ã¤ãã‚‚æŒ‡æ•°é–¢æ•°çš„ã«å°ã•ã„ã“ã¨ã‚’æŒ‡ã—ã¾ã™ã€‚è«–æ–‡ [5] ã«ã‚ˆã‚‹ã¨ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«åˆæœŸåŒ–ã—ãŸã‚ˆã†ãªæ·±ã„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä»˜ãå›è·¯ã®å ´åˆã€ä¼¼ãŸã‚Šå¯„ã£ãŸã‚Šã®æœŸå¾…å€¤ã‚’ç®—å‡ºã™ã‚‹ã“ã¨ã‹ã‚‰ã“ã®ã‚ˆã†ãªæ¡ä»¶ã«é™¥ã‚‹ãã†ã§ã™ã€‚

# è«–æ–‡ã‚µãƒ¼ãƒ™ã‚¤

ä»¥ä¸‹ã€å€‹ã€…ã®è«–æ–‡ã«ã¤ã„ã¦å°‘ã—çœºã‚ã¦ã¿ã¾ã—ã‚‡ã†ã€‚å…¨ä½“çš„ãªç·æ‹¬ã¯ã€ŒBarren Plateau ã¨ã¯ã€ã«ã¦æ—¢ã«ã¾ã¨ã‚ã¾ã—ãŸã®ã§ã€ã“ã“ã¯å…¨ã¦é£›ã°ã—ã¦ã‚‚å•é¡Œã‚ã‚Šã¾ã›ã‚“ã€‚

Qiskit textbook æˆ–ã¯è«–æ–‡ [2] ã§ã¯

- é‡å­ãƒ“ãƒƒãƒˆæ•° $n$ ã®é–¢æ•°ã¨ã—ã¦æŒ‡æ•°é–¢æ•°ã®ã‚ªãƒ¼ãƒ€ãƒ¼ã§å‹¾é…ãŒæ¶ˆãˆã‚‹
- é‡å­å›è·¯ãŒæ·±ããªã‚‹ã¨å‹¾é…ãŒæŒ‡æ•°é–¢æ•°çš„ã«æŠ‘åˆ¶ã•ã‚Œã‚‹

ã“ã¨ãŒç¤ºå”†ã•ã‚Œã¾ã—ãŸã€‚ä»¥ä¸‹ã€â€œBarren Plateauâ€ ã¯é•·ã„ã®ã§ã€ã—ã°ã—ã° â€œBPâ€ ã¨ç•¥ã—ã¾ã™ã€‚

é‡å­ãƒ“ãƒƒãƒˆæ•°ãŒå°‘ãªã„æ™‚ã‚„å›è·¯ãŒæµ…ã„æ™‚ã¯æ¯”è¼ƒçš„è¨“ç·´ãŒé€²ã‚€ã¨æ€ã„ã¾ã™ã€‚ä¸€æ–¹ã€è‰¯ã•ãã†ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒé–‹ç™ºã•ã‚ŒãŸæ™‚ã€

- å¤§ããªé‡å­ãƒ“ãƒƒãƒˆæ•° $n$ ã§ã‚‚é©ç”¨ã§ãã‚‹ã‹ï¼Ÿã¤ã¾ã‚Šã‚¹ã‚±ãƒ¼ãƒ«ã™ã‚‹ã‹ï¼Ÿ
- å¤å…¸ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«å¯¾ã™ã‚‹å„ªä½æ€§ã¯æœŸå¾…ã§ããã†ã‹ï¼Ÿ

ãŒæ°—ã«ãªã£ã¦ãã¾ã™ã€‚å„è«–æ–‡ã§ã¯ã“ã®è¦³ç‚¹ã§è­°è«–ãŒãªã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã«æ€ã‚ã‚Œã¾ã™ã€‚

è«–æ–‡ [3] ã§ã¯ä»¥ä¸‹ãŒç¤ºã•ã‚Œã¾ã—ãŸã€‚

- BP ã®ç™ºç”Ÿã¯ã‚³ã‚¹ãƒˆé–¢æ•°ä¾å­˜
- ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªè¦³æ¸¬é‡ã®æœŸå¾…å€¤ (è¦å…¨é‡å­ãƒ“ãƒƒãƒˆã®æ¸¬å®š) ã«ã‚ˆã‚‹ã‚³ã‚¹ãƒˆé–¢æ•° â†’ å›è·¯ã®æ·±ã•ã«ã‚ˆã‚‰ãš BP ãŒèµ·ã“ã‚Šå¾—ã‚‹ã€‚
- ãƒ­ãƒ¼ã‚«ãƒ«ãªè¦³æ¸¬é‡ã®æœŸå¾…å€¤ (å˜ä¸€é‡å­ãƒ“ãƒƒãƒˆã®æ¸¬å®šã®åˆç®—ã§ OK) ã«ã‚ˆã‚‹ã‚³ã‚¹ãƒˆ â†’ æ·±ã• $O(\log(n))$ ãªã‚‰ BP ã¯èµ·ã“ã‚‰ãªã„ã€‚
- åŒ–å­¦è¨ˆç®—ã§ã¯ Bravyi-Kitaev ãŒãƒ­ãƒ¼ã‚«ãƒ«ãª Pauli é …ã‚’å°ãã‚„ã™ã„ã®ã§ BP ã‚’é¿ã‘ã‚„ã™ã„

ã¨ã„ã†ã“ã¨ã§ã—ãŸã€‚å…¨ã¦ã®é‡å­ãƒ“ãƒƒãƒˆã‚’ä¸€åº¦ã«æ¸¬å®šã—ãªã„ã¨ãªã‚‰ãªã„ observable ã®ã‚±ãƒ¼ã‚¹ã§ã¯å›è·¯æ·±åº¦ã«ã‚ˆã‚‰ãš BP ãŒèµ·ã“ã‚Šå¾—ã‚‹ã¨ã„ã†ã“ã¨ã§ã™ã€‚
ã¤ã¾ã‚Šã€observable ã¨ã—ã¦ã¯ã€**éƒ¨åˆ†çš„ãªé‡å­ãƒ“ãƒƒãƒˆã®æ¸¬å®šçµæœã®åˆç®—ã§ã‚³ã‚¹ãƒˆé–¢æ•°ã‚’å®šç¾©ã§ãã‚‹ãƒ­ãƒ¼ã‚«ãƒ«ãªã‚‚ã®** ã‚’è¨­è¨ˆã™ã‚‹ã“ã¨ãŒé‡è¦ã«ãªã‚Šã¾ã™ã€‚é‡å­åŒ–å­¦è¨ˆç®—ã§ã¯ã€ãƒãƒŸãƒ«ãƒˆãƒ‹ã‚¢ãƒ³ã‚’é‡å­å›è·¯ã«å®Ÿè£…ã™ã‚‹éš›ã«ã€Jordan-Wigner å¤‰æ›ã¨ Bravyi-Kitaev å¤‰æ›ãŒè€ƒãˆã‚‰ã‚Œã¾ã™ãŒã€å¾Œè€…ã®ã»ã†ãŒãƒ­ãƒ¼ã‚«ãƒ«ãª Pauli é …ã‚’å°ãã‚„ã™ã„ã®ã§å¥½ã¾ã—ã„ã¨ã„ã†ã“ã¨ã®ã‚ˆã†ã§ã™ã€‚

ä½™è«‡ã§ã™ãŒã€Ansatz ã«ã¯é‡å­è«–ã«åŸºã¥ãã‚‚ã®ã¨ã€é‡å­ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã«ã¨ã£ã¦éƒ½åˆã®è‰¯ã„ã‚‚ã®ãŒã‚ã‚Šã¾ã™ã€‚å¾Œè€…ã¯ Hardware-efficient ansatz (HEA) ã¨å‘¼ã°ã‚Œã¾ã™ãŒã€ã“ã‚Œã«ã¤ã„ã¦ã¯è«–æ–‡ [14] ã«ã‚ˆã‚‹ã¨ã€é‡å­åŒ–å­¦è¨ˆç®—ã®ã‚ˆã†ãª VQA ã§ã¯ HEA ã®ä½¿ç”¨ã¯ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã®ã»ã†ãŒå¤šã„ã‚ˆã†ã§ã™ã€‚é‡å­è«–ã«åŸºã¥ã„ã¦é©åˆ‡ãª ansatz ã‚’ç”¨æ„ã™ã‚‹ã“ã¨ãŒå®¹æ˜“ãªã®ã§ãã¡ã‚‰ã®ã»ã†ãŒå¥½ã¾ã—ã„ã‚ˆã†ã§ã™ã€‚

ã•ã¦ã€ã“ã“ã¾ã§ã§ BP ã®å„ä»‹ã•ãŒè¦‹ãˆã¦ã„ã¾ã™ãŒã“ã“ã¾ã§ã¯ç†è«–çš„ãª BP ã§ã™ã€‚è«–æ–‡ [6] ã«ã‚ˆã‚‹ã¨ã€NISQ ãªã‚‰ã§ã¯ã®ãƒã‚¤ã‚ºã«ã‚ˆã‚‹ BP ã‚‚ã‚ã‚‹ã¨ã„ã†ã“ã¨ã§ã™ã€‚

- ãƒã‚¤ã‚ºã¨BPã®é–¢ä¿‚ã‚’è¦‹ã‚‹ã€‚è„±åˆ†æ¥µãƒã‚¤ã‚ºã¨ Pauli ãƒã‚¤ã‚ºã‚’å«ã‚€å±€æ‰€ãƒã‚¤ã‚ºãƒ¢ãƒ‡ãƒ«ã‚’æƒ³å®šã€‚
- ãƒã‚¤ã‚ºãªã—æƒ³å®šã® BP å›é¿ç­–ã§ã‚‚å›é¿ã§ããªã„ã€‚
- å›é¿ç­–ã¯ H/W ã®ãƒã‚¤ã‚ºã‚’ä¸‹ã’ã‚‹ã¨ã‹å›è·¯ã‚’æ·±ãã—ãªã„ãªã©ã€‚

ã•ã¦ã€ã§ã¯ BP ã®å›é¿ç­–ã¯ã‚ã‚‹ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿã“ã‚Œã«ã¤ã„ã¦ã¯ã–ã£ãã‚Šã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚‹ã‚ˆã†ã§ã™:

- å›è·¯ã‚’æµ…ãã™ã‚‹ ([2][6] ãªã©)
- é‡å­ãƒ“ãƒƒãƒˆæ•°ã‚’å¢—ã‚„ã•ãªã„ and/or ç‹¬ç‰¹ãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’ä½¿ã† ([2][9])
- è¦³æ¸¬é‡ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ãªè¨­è¨ˆã«ã™ã‚‹ ([3])
- ç©ºé–“çš„ã€æ™‚é–“çš„ã«ç›¸é–¢ã®ã‚ã‚‹ã‚²ãƒ¼ãƒˆå±¤ã‚’å«ã‚€å›è·¯ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’åˆ©ç”¨ã™ã‚‹ãªã©ã—ã¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ç›¸é–¢é–¢ä¿‚ã‚’æŒãŸã›ã‚‹ ([4])
- è¨“ç·´ã‚’æµ…ã„å±¤ã‹ã‚‰å§‹ã‚ã€ã“ã‚Œã‚’å›ºå®šã—ãªãŒã‚‰å¾ã€…ã«å±¤ã‚’è¿½åŠ ã—ã¦æ·±ãã—ã¦ã„ã ([5][11])

ã‚‚ã— Barren Plateau ãŒèµ·ã“ã‚‹ã‚±ãƒ¼ã‚¹ã«è©²å½“ã™ã‚‹ã¨ã€ãã‚Œã§ã‚‚è¨“ç·´ã‚’é€²ã‚ã‚ˆã†ã¨ã™ã‚‹ã¨ã€è¨ˆç®—ã®ç²¾åº¦ã‚’é«˜ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã«ã¯å›è·¯ã‚’ã‚¹ã‚±ãƒ¼ãƒ«ã—ãŸæ™‚ã«ã€BP ã‚’èµ·ã“ã™ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å€‹æ•°ã«ã¤ã„ã¦æŒ‡æ•°é–¢æ•°çš„ã«å¢—å¤§ã™ã‚‹ã‚·ãƒ§ãƒƒãƒˆæ•°ã‚’è¦æ±‚ã™ã‚‹ã‚ˆã†ã§ã™ã€‚ã“ã®ã“ã¨ã¯å¤å…¸è¨ˆç®—ã«å¯¾ã™ã‚‹é‡å­è¨ˆç®—ã®å„ªä½æ€§ã‚’å¦å®šã™ã‚‹ã“ã¨ã«ãªã‚‹ã®ã§æ„å‘³ãŒã‚ã‚Šã¾ã›ã‚“ã€‚è«–æ–‡ [7] ã®è¨€è‘‰ã‚’å€Ÿã‚Šã‚‹ã¨

- BP ã®å‡ºç¾æ™‚ç‚¹ã§ã‚¢ã‚¦ãƒˆãªã®ã§ã€BP ã®å‡ºç¾ã‚’å®Œå…¨ã«é¿ã‘ã‚‹æˆ¦ç•¥ã®é–‹ç™ºã‚’ã™ã‚‹ã»ã†ãŒè‰¯ã„

ã¨ã„ã†ã“ã¨ã«ãªã‚‹ã‚ˆã†ã§ã™ã€‚è«–æ–‡ [7] ã§ã¯ã€å‹¾é…é™ä¸‹æ³•ã¯ 1 éšã®å¾®åˆ†ã ã‘ã‚’ä½¿ã£ã¦ã„ã‚‹ãŒã€é«˜éšã®å¾®åˆ†ã‚’ä½¿ã†ã¨çŠ¶æ³ãŒæ‰“é–‹ã§ãã‚‹ã®ã§ã¯ï¼Ÿã¨ã„ã†ç™ºæƒ³ã§ç ”ç©¶ãŒã•ã‚Œã¾ã—ãŸã€‚ã—ã‹ã—ã€

- é«˜éšå°é–¢æ•° (e.g. 2 éšå°é–¢æ•°ã€‚ä¾‹ãˆã° Hessian)ã¯ BP å›é¿ã«å½¹ç«‹ã¤ã‹ï¼Ÿ â†’ NOã€‚æŒ‡æ•°é–¢æ•°ç²¾åº¦ãŒå¿…è¦ã€‚
- BP ã¯é«˜éšã«ã¾ã§æ ¹æ·±ã„å½±éŸ¿ã‚’åŠã¼ã™ç¾è±¡ã€‚

ã¨ã„ã†ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã—ãŸã€‚

é•ã†è¦³ç‚¹ã§ã¯ã€Œå‹¾é…é™ä¸‹æ³•ã‚’ä½¿ã‚ãªã‘ã‚Œã°ä½•ã¨ã‹ãªã‚‹ã®ã§ã¯ï¼Ÿã€ã¨ã„ã†è€ƒãˆæ–¹ã‚‚ã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯è«–æ–‡ [10] ã§ç ”ç©¶ã•ã‚Œã¾ã—ãŸã€‚ã¨ã“ã‚ãŒã€åŒè«–æ–‡ã®æ‰‹çµæœã¨ã—ã¦

- å‹¾é…ã‚’ä½¿ã‚ãªã„æœ€é©åŒ–ã§ã‚‚ BP ã¯è§£æ±ºã—ãªã„

ã¨ã„ã†ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã—ãŸã€‚è«–æ–‡ [5] ã«ã‚ˆã‚‹ã¨ã€Œãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«åˆæœŸåŒ–ã—ãŸã‚ˆã†ãªæ·±ã„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä»˜ãå›è·¯ã®å ´åˆã€ä¼¼ãŸã‚Šå¯„ã£ãŸã‚Šã®æœŸå¾…å€¤ã‚’ç®—å‡ºã™ã‚‹ã€ã¨ã„ã†ã“ã¨ã§ã—ãŸã®ã§ã€å¾®åˆ†è¨ˆç®—ã«å¿…è¦ãªç„¡é™å°ã®è¿‘å‚ã ã‘ã§ãªãã€å°‘ã€…é›¢ã‚ŒãŸã¨ã“ã‚ã§ã‚‚ã‚³ã‚¹ãƒˆé–¢æ•°ã®å·®ãŒæ¥µã‚ã¦å°ã•ã„ã€ã¤ã¾ã‚Šå°åœ°ä¸Šã®å½¢çŠ¶ãŒæ€ã£ãŸä»¥ä¸Šã«åºƒãåºƒãŒã£ã¦ã„ã‚‹ã®ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

ã“ã“ã¾ã§è¦‹ã¦ãã¾ã™ã¨ã€é‡å­è¨ˆç®—ã§ç™ºç”Ÿã™ã‚‹ Barren Plateau ã¨å¤å…¸æ©Ÿæ¢°å­¦ç¿’ã§è¦‹ã‚‰ã‚Œã‚‹å‹¾é…æ¶ˆå¤±ã®ç¾è±¡ã«ã¤ã„ã¦é–¢ä¿‚æ€§ãŒæ°—ã«ãªã£ã¦ãã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚åŒæ™‚ã«ã“ã‚Œã¾ã§è¦‹ãŸè«–æ–‡ãŒç¤ºå”†ã—ã¦ã„ã‚‹ã‚ˆã†ã«ã€é‡å­è¨ˆç®—ã®ãã‚Œã¯å¤å…¸æ©Ÿæ¢°å­¦ç¿’ã®ãã‚Œã¨å°‘ã—ç•°ãªã‚‹ã®ã§ã¯ï¼Ÿã¨ã„ã†æ„Ÿè§¦ã‚‚å¾—ã¦ã„ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã“ã‚Œã«ã¤ã„ã¦ç ”ç©¶ã—ãŸã‚‚ã®ãŒè«–æ–‡ [13] ã«ãªã‚Šã¾ã™ã€‚åŒè«–æ–‡ã®å†…å®¹ã‚’è¦ç´„ã™ã‚‹ã¨ (ã“ã“ã§ã¯é‡å­ãƒ“ãƒƒãƒˆæ•°ã®è¦³ç‚¹ã§ã™ãŒ) ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

- å¤å…¸NNã®å‹¾é…æ¶ˆå¤±ã¯é€£é–ç‡ã§ã©ã‚“ã©ã‚“å°ã•ãªå› å­ãŒæ›ã‘åˆã‚ã•ã£ã¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å¤‰å‹•ãŒå°ã•ããªã‚‹**å‹•çš„ãªæ€§è³ª**ã®ã‚‚ã®
- é‡å­å›è·¯ã®ä¸æ¯›ã®å°åœ°ã¯é‡å­ãƒ“ãƒƒãƒˆæ•°ã€å³ã¡ãƒ’ãƒ«ãƒ™ãƒ«ãƒˆç©ºé–“ã®æ¬¡å…ƒæ•°ã«ã‚ˆã‚Šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å¤‰å‹•ãŒæŠ‘åˆ¶ã•ã‚Œã‚‹**é™çš„ãªæ€§è³ª**ã®ã‚‚ã®

ä»¥ä¸Šã€ç°¡å˜ã«è«–æ–‡ã®å†…å®¹ã‚’è¦‹ã¦ãã¾ã—ãŸã€‚ä»¥ä¸‹ã§ã¯ç°¡å˜ãªå®Ÿè£…ã‚’é€šã˜ã¦è‚Œæ„Ÿè§¦ã§ Barren Plateau ã‚’è¦‹ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚

# æ¤œè¨¼

[blueqat SDK](https://github.com/Blueqat/Blueqat) + [cuStateVec](https://docs.nvidia.com/cuda/cuquantum/custatevec/) ã§æ¤œè¨¼ã‚’è¡Œã„ã¾ã™ã€‚Ansatz ã®è¨­è¨ˆã¨ã—ã¦ã¯é©å½“ãªå†…å®¹ã«ãªã‚Šã¾ã™ãŒã€Barren Plateau ã‚’èµ·ã“ã—ã‚„ã™ãã†ãªã‚°ãƒ­ãƒ¼ãƒãƒ« (éå±€æ‰€çš„) ãªã‚‚ã®ã‚’ç”¨æ„ã—ã€å›è·¯ã®æ·±ã•ã¯ä¸€å®šã¨ã—ã¦é‡å­ãƒ“ãƒƒãƒˆã‚’ã‚¹ã‚±ãƒ¼ãƒ«ã—ã¾ã™ã€‚åˆæœŸå€¤ã«ã‚‚ç›¸é–¢é–¢ä¿‚ã‚’æŒãŸã›ãšã«ãƒ©ãƒ³ãƒ€ãƒ ã¨ã—ã¾ã™ã€‚

## å¤‰åˆ†å›è·¯ã®å¤–è¦³

3 é‡å­ãƒ“ãƒƒãƒˆã®ã‚±ãƒ¼ã‚¹ã§å¤‰åˆ†å›è·¯ã‚’è¦‹ã¦ã¿ã¾ã™ã€‚

ã€Œå›è»¢ã‚²ãƒ¼ãƒˆã®é©ç”¨ + CNOT ã§ã®éš£æ¥é‡å­ãƒ“ãƒƒãƒˆåŒå£«ã®å·»ãè¾¼ã¿ã€ã‚’ 1 ãƒ–ãƒ­ãƒƒã‚¯ã¨ã—ã¦ã€ãƒ–ãƒ­ãƒƒã‚¯ã‚’ 2 ã¤ä¸¦ã¹ãŸã‚‚ã®ã‚’ $U(\theta)$ ã¨ã—ã¦ã„ã¾ã™ã€‚ãƒãƒŸãƒ«ãƒˆãƒ‹ã‚¢ãƒ³ã¯ $H=Z \otimes Z \otimes Z$ ã¨ã—ã¦ã€å¤‰åˆ†å›è·¯ã¯ $\braket{0 | U(\theta)^\dagger H U(\theta) | 0}$ ã¨ã—ã¦ã„ã¾ã™ã€‚Barren Plateau ã‚’è¦‹ã¦ã¿ãŸã„ã®ã§ã€æ„å›³çš„ã«è‰¯ããªã•ãã†ãªå›è·¯ã«ã—ã¦ã„ã¾ã™ã€‚

![](/images/dwd-blueqat03/001.png)

$n$ é‡å­ãƒ“ãƒƒãƒˆã®ã‚±ãƒ¼ã‚¹ã§ã¯æ·±ã•ã‚’ä¿ã£ãŸã¾ã¾ã§é‡å­ãƒ“ãƒƒãƒˆæ•°ã‚’å¢—ã‚„ã—ã¦ã„ãã¾ã™ã€‚è«–æ–‡ã®å†…å®¹ã«ã‚ˆã‚‹ã¨ã“ã®ã‚ˆã†ãªã‚±ãƒ¼ã‚¹ã§ã‚‚å‹¾é…ã¯æŒ‡æ•°é–¢æ•°çš„ã«æŠ‘åˆ¶ã•ã‚Œã‚‹ã¨è€ƒãˆã‚‰ã‚Œã¾ã™ã€‚

ãƒãƒŸãƒ«ãƒˆãƒ‹ã‚¢ãƒ³ $H=Z^{\otimes n}$ ã¯ãƒ†ãƒ³ã‚½ãƒ«ç©ã‚’è¨ˆç®—ã™ã‚‹ã“ã¨ã§å¯¾è§’è¡Œåˆ—ã§ã‚ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã€å¯¾è§’æˆåˆ†ã«ã¯ $1$ ã¨ $-1$ ã—ã‹å‡ºã¾ã›ã‚“ã€‚å¾“ã£ã¦å›ºæœ‰å€¤ã‚‚ $1$ ã¨ $-1$ ã§ã™ã€‚ä»Šå›ã¯æœŸå¾…å€¤ã®æœ€å°åŒ–ã‚’è¡Œã†ã®ã§ã€æœ€é©åŒ–ãŒé€²ã‚€ã¨ $-1$ ã«å‘ã‹ã£ã¦æœŸå¾…å€¤ã¯æ¸›å°‘ã—ã¦ã„ãã“ã¨ã«ãªã‚Šã¾ã™ã€‚

## æº–å‚™

[blueqatSDKã‹ã‚‰cuStateVecã‚’å®Ÿè¡Œ](https://blueqat.com/yuichiro_minato2/16680671-dbe9-4ab4-8830-3e6f185ad266) ã‚’å‚è€ƒã«ã€`cuStateVec` ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’è¿½åŠ ã™ã‚‹ã€‚æˆ–ã¯æ—¢ã«ç”¨æ„ã—ãŸã‚‚ã® (ä¸‹è¨˜å‚ç…§) ã‚’ä½¿ã„ã¾ã™ã€‚å¾Œè€…ã¯å‰è€…ã‚’ãƒ™ãƒ¼ã‚¹ã«ã—ã¦ã„ã¾ã™ãŒã€å¯¾å¿œã‚²ãƒ¼ãƒˆã‚’å¤šå°‘å¢—ã‚„ã—ã¦ã„ã¾ã™ã€‚ä½†ã—ã€ä»Šå›ã®å®Ÿé¨“ã§ã¯æ‹¡å¼µã—ãŸéƒ¨åˆ†ã¯åˆ©ç”¨ã—ã¾ã›ã‚“ã€‚

ä»¥ä¸‹ã§ã¯ `matplotlib` ã‚’ã‚ã–ã¨ãƒ€ã‚¦ãƒ³ã‚°ãƒ¬ãƒ¼ãƒ‰ã—ã¦ã„ã¾ã™ãŒã€Colab ä¸Šã§æ–°ã—ã„ matplotlib ã®ä½¿ç”¨ã§æ”¯éšœãŒå‡ºã‚‹éƒ¨åˆ†ãŒã‚ã£ãŸã®ã§ã€ä»Šå›ã¯ãƒ€ã‚¦ãƒ³ã‚°ãƒ¬ãƒ¼ãƒ‰ã—ã¦å¯¾å¿œã—ãŸãŸã‚ã§ã™ã€‚

```python
%%bash
pip install git+https://github.com/derwind/Blueqat.git@cuquantum-0.1
pip install -U pip cuquantum-python cupy-cuda11x
pip install matplotlib==3.2.2
```

## å¿…è¦ãªé–¢æ•°ã®å®šç¾©

ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã€ansatz ã®å®šç¾©ç­‰ã€…ã‚’è¡Œã„ã¾ã™ã€‚

```python
# Ansatzã€ãƒãƒŸãƒ«ãƒˆãƒ‹ã‚¢ãƒ³ã€ãƒãƒŸãƒ«ãƒˆãƒ‹ã‚¢ãƒ³ã®æœŸå¾…å€¤ã‚’å¾—ã‚‹å¤‰åˆ†å›è·¯ã‚’å®šç¾©
def make_circuit(n_qubits, reps, thetas: List[float]=[]):
    ansatz = Circuit()
    for r in range(reps):
        for i in range(n_qubits):
            ansatz.rx(thetas[n_qubits*r+i])[i]
        for i in range(n_qubits-1):
            ansatz.cx[i, i+1]
        if n_qubits > 1:
            ansatz.cx[n_qubits-1, 0]

    hamiltonian = Circuit(n_qubits).z[:]
    return ansatz + hamiltonian + ansatz.dagger()

# é‡å­å›è·¯ã‚’å®Ÿè¡Œã—ã¦æœŸå¾…å€¤ã‚’è¨ˆç®—
def get_expectation_value(c: Circuit):
    sv = c.run(backend='cusv')
    return float(sv[0].real)

# ä½ç›¸ã‚’ [0, 2Ï€] ã«å…¥ã‚‹ã‚ˆã†ã«æ­£è¦åŒ–
def normalize_phase(phase):
    return ((phase/(2*np.pi))%1) * 2*np.pi

# å‹¾é…é™ä¸‹æ³•ã‚’å®Ÿè¡Œã—ã¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ›´æ–°ã€‚
# å‹¾é…è¨ˆç®—ã«ã¯ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚·ãƒ•ãƒˆå‰‡ã‚’ä½¿ç”¨ã€‚
def update_thetas(n_qubits, reps, thetas: List[float], lr=0.01):
    new_thetas = thetas[:]
    grads = [0]*len(thetas)
    # parameter shift rule
    for i, theta in enumerate(thetas):
        theta2 = thetas[:]
        theta2[i] = normalize_phase(theta + np.pi/2)
        ev2 = get_expectation_value(make_circuit(n_qubits, reps, theta2))
        theta3 = thetas[:]
        theta3[i] = normalize_phase(theta - np.pi/2)
        ev3 = get_expectation_value(make_circuit(n_qubits, reps, theta3))
        grad = ev2 - ev3
        new_thetas[i] = theta - lr * grad
        grads[i] = grad
    return new_thetas, grads

def calc_n_thetas(n_qubits, reps):
    return n_qubits * reps

def make_initial_phases(n_qubits, reps):
    n_thetas = calc_n_thetas(n_qubits, reps)
    return np.array([random.random()*2*np.pi for _ in range(n_thetas)])

# å®Ÿé¨“ã‚’å®Ÿè¡Œ
def do_experiment(n_qubits, reps=2, n_epoch=300) -> Tuple[List[float],list]:
    init_thetas = make_initial_phases(n_qubits, reps)

    expactation_values = []
    grads_list = [] # grads of each epoch
    thetas = init_thetas[:]

    for epoch in range(n_epoch):
        c = make_circuit(n_qubits, reps, thetas)
        ev = get_expectation_value(c)
        expactation_values.append(ev)
        thetas, grads = update_thetas(n_qubits, reps, thetas)
        grads_list.append(grads)

    return expactation_values, grads_list
```

# å®Ÿé¨“

å¾Œã§å‹¾é…ã®çµ¶å¯¾å€¤ã«ã¤ã„ã¦å¹³å‡ã¨æ¨™æº–åå·®ã‚’è¦‹ãŸã„ã®ã§ã€çµæœã‚’æ ¼ç´ã™ã‚‹è¾æ›¸ã‚’ç”¨æ„ã—ã¾ã™ã€‚å„ $\theta_i$ ã”ã¨ã®åå°é–¢æ•° $\frac{\partial \braket{0 | U(\theta)^\dagger H U(\theta) | 0}}{\partial \theta_i}$ ã®çµ¶å¯¾å€¤ã‚’æ±‚ã‚ã€ã‚¨ãƒãƒƒã‚¯ã”ã¨ã«å¹³å‡ã¨åˆ†æ•£ã‚’æ±‚ã‚ã‚‹å½¢ã«ã—ã¾ã™ã€‚ã“ã‚Œã‚’è¨“ç·´åºç›¤ã® 10 ã‚¨ãƒãƒƒã‚¯ã«ã¤ã„ã¦è¨ˆç®—ã—ã€é‡å­ãƒ“ãƒƒãƒˆã”ã¨ã®å‚¾å‘ã‚’ãƒ—ãƒ­ãƒƒãƒˆã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚

```python
n_qubits2grads = {}
```

ãã‚Œã§ã¯ã€1 é‡å­ãƒ“ãƒƒãƒˆã®å ´åˆã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

```python
n_qubits = 1

expactation_values, _ = do_experiment(n_qubits)
```

![](/images/dwd-blueqat03/002.png)

ã‚ã‚Šã¨ã™ãã« $-1$ ã«åæŸã—ã¾ã—ãŸã€‚æ¬¡ã« 2 é‡å­ãƒ“ãƒƒãƒˆã®å ´åˆã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

```python
n_qubits = 2

expactation_values, _ = do_experiment(n_qubits)
```

![](/images/dwd-blueqat03/003.png)

åˆæœŸå€¤ãŒãƒ©ãƒ³ãƒ€ãƒ ãªã®ã§å¤šå°‘æºã‚‰ãã¾ã™ãŒæœ€çµ‚çš„ã«ã¯ $-1$ ã«åæŸã—ã¦ã„ã£ã¦ã„ã¾ã™ã€‚å°‘ã—ã¨ã°ã—ã¦ 8 é‡å­ãƒ“ãƒƒãƒˆã®å ´åˆã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚å®Ÿè¡Œã«ã¯ GPU ã«ã‚‚ã‚ˆã‚Šã¾ã™ãŒ 10 åˆ†ãã‚‰ã„ã‹ã‹ã‚Šã¾ã™ã€‚

```python
n_qubits = 8

expactation_values, _ = do_experiment(n_qubits)
```

![](/images/dwd-blueqat03/006.png)

å¤§åˆ†åºç›¤ã«å¹³å¦ãªå°åœ°çš„ãªå½¢çŠ¶ãŒå‡ºã¦ãã¾ã—ãŸãŒã€ä¸€å¿œ $-1$ ã«åæŸã—ãŸã‚ˆã†ã§ã™ã€‚

## å‹¾é…ã®å¹³å‡ã¨æ¨™æº–åå·®

ä»¥ä¸‹ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã§ 1 é‡å­ãƒ“ãƒƒãƒˆã®ã‚±ãƒ¼ã‚¹ã‹ã‚‰ 25 é‡å­ãƒ“ãƒƒãƒˆã®ã‚±ãƒ¼ã‚¹ã¾ã§è¨“ç·´åºç›¤ã® 10 ã‚¨ãƒãƒƒã‚¯åˆ†ã®å‹¾é…ã®çµ¶å¯¾å€¤ã®å¹³å‡ã¨æ¨™æº–åå·®ã«ã¤ã„ã¦é›†ã‚ã¦ã¿ã¾ã™ã€‚å®Ÿè¡Œã¯æã‚‰ã 1 æ™‚é–“ãã‚‰ã„ã‹ã‹ã‚Šã¾ã™ã€‚

GPU ãƒ¡ãƒ¢ãƒªæ¬¡ç¬¬ã§ã™ãŒã€Colab ä¸Šã§ã‚ã‚Œã° 28 é‡å­ãƒ“ãƒƒãƒˆãã‚‰ã„ã¾ã§ã¯ã„ã‘ã‚‹ã¨æ€ã„ã¾ã™ãŒã€ä½™è£•ã‚’è¦‹ã¦ 25 é‡å­ãƒ“ãƒƒãƒˆã¾ã§ã«ã—ã¦ã„ã¾ã™ã€‚

```python
for n_qubits in range(1, 25+1):
    expactation_values, grads_list = do_experiment(n_qubits, n_epoch=10)
    n_qubits2grads[n_qubits] = grads_list[:10]
```

ã‚°ãƒ©ãƒ•ã‚’å¯è¦–åŒ–ã—ã¾ã™ã€‚

```python
def plot_graph(n_qubits2grads, yscale_value='linear', show_errorbar=True):
    n_qubits_range = range(1, len(n_qubits2grads)+1)
    mean_abs_grads = []
    std_abs_grads = []
    for n_qubits, grads_list in sorted(n_qubits2grads.items(), key=lambda k_v: k_v[0]):
        abs_grads = []
        for grads in grads_list:
            for grad in grads:
                abs_grads.append(abs(grad))
        mean_abs_grads.append(np.mean(abs_grads))
        std_abs_grads.append(np.std(abs_grads))

    fig, ax = plt.subplots()
    yerr = std_abs_grads if show_errorbar else None
    ax.errorbar(x=n_qubits_range, y=mean_abs_grads, yerr=yerr, fmt='-o', color='b')
    ax.set_xlabel('num of qubits')
    ax.set_ylabel('mean abs grads')
    ax.set_title('mean abs grads per each epoch')
    ax.set_yscale(yscale_value)
    plt.grid()
    plt.show()

display(plot_graph(n_qubits2grads, yscale_value='linear'))
```

![](/images/dwd-blueqat03/007.png)

ãƒªãƒ‹ã‚¢ãªå¯è¦–åŒ–ã§ã¯å‹¾é…ã¯ã©ã‚“ã©ã‚“æ¸›å°‘ã—ã¦ã€ãã®åˆ†æ•£ã‚‚ã»ã¨ã‚“ã©ãªããªã£ã¦ã„ã£ã¦ã„ã‚‹æ§˜å­ãŒè¦‹ã‚‰ã‚Œã¾ã™ã€‚ã‚ˆã‚Šè©³ç´°ã«è¦‹ã‚‹ãŸã‚ã«å¯¾æ•°ã‚°ãƒ©ãƒ•ã§è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

```python
display(plot_graph(n_qubits2grads, yscale_value='log', show_errorbar=False))
```

![](/images/dwd-blueqat03/008.png)

å¯¾æ•°ã‚°ãƒ©ãƒ•ã®ä¸­ã§æ¦‚ã­ç·šå½¢ã«æ¸›å°‘ã—ã¦ã„ã£ã¦ã„ã¾ã™ã€‚ã¤ã¾ã‚Šã€$\log y = -a x + b$ ãªã®ã§ã€ä¸¡è¾ºã®æŒ‡æ•°ã‚’ã¨ã£ã¦ $y = C \exp (-ax)$ ã¨**æŒ‡æ•°é–¢æ•°çš„ã«å‹¾é…ãŒæŠ‘åˆ¶ã•ã‚Œã¦ã„ã‚‹**ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚

# ã¾ã¨ã‚

Barren Plateau ã«é–¢ã™ã‚‹ç°¡å˜ãªè«–æ–‡ã®ã‚µãƒ¼ãƒ™ã‚¤ã¨æ¤œè¨¼ã‚’è¡Œã£ã¦ã¿ã¾ã—ãŸã€‚æ¤œè¨¼ã«ã¤ã„ã¦ã¯æœ¬å½“ã«å¦¥å½“ã‹ï¼Ÿã¨å•ã‚ã‚Œã‚‹ã¨ç–‘å•ã¯ã‚ã‚Šã¾ã™ãŒã€é›°å›²æ°—ã¨ã—ã¦é‡å­ãƒ“ãƒƒãƒˆæ•°ãŒå¢—ãˆã‚‹ã“ã¨ã§å‹¾é…é™ä¸‹æ³•ãŒã‹ãªã‚Šå³ã—ã„ã“ã¨ã«ãªã‚‹ã“ã¨ãŒè¦‹ãˆãŸã‚ˆã†ã«æ€ã„ã¾ã™ã€‚ã—ã‹ã‚‚ã€ç†è«–çš„ãªå‹¾é…å€¤ã‚’ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚·ãƒ•ãƒˆå‰‡ã§æ±‚ã‚ã‚‹ GPU ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã®ã§ã€ãƒã‚¤ã‚ºã®ãªã„æŒ‡æ•°é–¢æ•°çš„ç²¾åº¦ã®å‹¾é…è¨ˆç®—ã«ç›¸å½“ã™ã‚‹ã«ã‚‚é–¢ã‚ã‚‰ãšã€ã§ã™ã€‚

ã“ã®æ–¹é¢ãŒä»Šå¾Œã©ã®ã‚ˆã†ã«ãªã£ã¦ã„ãã®ã‹ã¯åˆ†ã‹ã‚Šã¾ã›ã‚“ãŒã€å¼•ãç¶šãå‹•å‘ã‚’è¦‹ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚

# å‚è€ƒæ–‡çŒ®

- [1] [å¤‰åˆ†åˆ†é¡](https://ja.learn.qiskit.org/course/machine-learning/variational-classification), Qiskit textbook
- [2] Jarrod R. McClean, Sergio Boixo, Vadim N. Smelyanskiy, Ryan Babbush, Hartmut Neven, _[Barren plateaus in quantum neural network training landscapes](https://arxiv.org/abs/1803.11173)_, arXiv, 2018
- [3] M. Cerezo, Akira Sone, Tyler Volkoff, Lukasz Cincio, Patrick J. Coles, _[Cost Function Dependent Barren Plateaus in Shallow Parametrized Quantum Circuits](https://arxiv.org/abs/2001.00550)_, arXiv, 2020
- [4] Tyler Volkoff, Patrick J. Coles, _[Large gradients via correlation in random parameterized quantum circuits](https://arxiv.org/abs/2005.12200)_, arXiv, 2020
- [5] Andrea Skolik, Jarrod R. McClean, Masoud Mohseni, Patrick van der Smagt, Martin Leib, _[Layerwise learning for quantum neural networks](https://arxiv.org/abs/2006.14904)_, arXiv, 2020
- [6] Samson Wang, Enrico Fontana, M. Cerezo, Kunal Sharma, Akira Sone, Lukasz Cincio, Patrick J. Coles, _[Noise-Induced Barren Plateaus in Variational Quantum Algorithms](https://arxiv.org/abs/2007.14384)_, arXiv, 2020
- [7] M. Cerezo, Patrick J. Coles, _[Higher Order Derivatives of Quantum Neural Networks with Barren Plateaus](https://arxiv.org/abs/2008.07454)_, arXiv, 2020
- [8] Benjamin Commeau, M. Cerezo, ZoÃ« Holmes, Lukasz Cincio, Patrick J. Coles, Andrew Sornborger, _[Variational Hamiltonian Diagonalization for Dynamical Quantum Simulation](https://arxiv.org/abs/2009.02559)_, arXiv, 2020
- [9] Arthur Pesah, M. Cerezo, Samson Wang, Tyler Volkoff, Andrew T. Sornborger, Patrick J. Coles, _[Absence of Barren Plateaus in Quantum Convolutional Neural Networks](https://arxiv.org/abs/2011.02966)_, arXiv, 2020
- [10] Andrew Arrasmith, M. Cerezo, Piotr Czarnik, Lukasz Cincio, Patrick J. Coles, _[Effect of barren plateaus on gradient-free optimization](https://arxiv.org/abs/2011.12245)_, arXiv, 2020
- [11] Xiaoyuan Liu, Anthony Angone, Ruslan Shaydulin, Ilya Safro, Yuri Alexeev, Lukasz Cincio, _[Layer VQE: A Variational Approach for Combinatorial Optimization on Noisy Quantum Computers](https://arxiv.org/abs/2102.05566)_, arXiv, 2021
- [12] Eric R. Anschuetz, Bobak T. Kiani, _[Beyond Barren Plateaus: Quantum Variational Algorithms Are Swamped With Traps](https://arxiv.org/abs/2205.05786)_, arXiv, 2022
- [13] Junyu Liu, Zexi Lin, Liang Jiang, _[Laziness, Barren Plateau, and Noise in Machine Learning](https://arxiv.org/abs/2206.09313)_, arXiv, 2022
- [14] Lorenzo Leone, Salvatore F.E. Oliviero, Lukasz Cincio, M. Cerezo, _[On the practical usefulness of the Hardware Efficient Ansatz](https://arxiv.org/abs/2211.01477)_, arXiv, 2022
