---
title: "ÊúÄÈÅ©Âåñ„Å´„Å§„ÅÑ„Å¶ËÄÉ„Åà„Çã (2) ‚Äî SVM"
emoji: "üìà"
type: "tech" # tech: ÊäÄË°ìË®ò‰∫ã / idea: „Ç¢„Ç§„Éá„Ç¢
topics: ["Ê©üÊ¢∞Â≠¶Áøí", "„Éù„Ç®„É†"]
published: true
---

# ÁõÆÁöÑ

[ÂâçÂõû](/derwind/articles/dwd-optimization01)„Å´Âºï„ÅçÁ∂ö„Åç„Å®„ÅÑ„ÅÜÂΩ¢„Åß‰ªäÂõû„ÅØ SVMÔºà„Çµ„Éù„Éº„Éà„Éô„ÇØ„Çø„Éº„Éû„Ç∑„É≥Ôºâ„ÇíÊâ±„ÅÜ„ÄÇ

SVM „ÅØ‰Ωï„Å®„Å™„ÅèÊú¨„ÅßË™≠„Çì„Åß‰Ωï„Å®„Å™„Åè„Çµ„Éù„Éº„Éà„Éô„ÇØ„Éà„É´„Å®Ê±∫ÂÆöÂ¢ÉÁïå„Å®„ÅÆ„Éû„Éº„Ç∏„É≥„ÇíÊúÄÂ§ßÂåñ„Åô„Çã„Çà„ÅÜ„Å´ÊúÄÈÅ©Âåñ„Åï„Çå„Çã„Å®„ÅÑ„Å£„Åü„Åì„Å®„ÇíË™≠„Çì„Åß„Åù„Çå„Å™„Çä„Å´Á¥çÂæó„Åó„ÄÅAPI „ÇíÂè©„Åè„Åì„Å®„Å´„Å™„Çã„Å®ÊÄù„ÅÜ„ÄÇÁµêÂ±Ä‰Ωï„ÅåË°å„Çè„Çå„Å¶„ÅÑ„Çã„ÅÆ„Åã„Åï„Å£„Å±„ÇäÂàÜ„Åã„Çâ„Å™„ÅÑ„Åæ„Åæ„Å´„Å™„Çã„ÅÆ„Åß„ÄÅÂÆüÈöõ„Å´Êâã„ÇíÂãï„Åã„Åó„Å¶Ë®àÁÆó„Çí„Åó„Å¶„Åø„Åü„ÅÑ„Å®ÊÄù„ÅÜ„ÄÇ

# ‰ªäÂõû„ÅÆÁØÑÂõ≤

3 ÁÇπ„Åã„Çâ„Å™„Çã„Éá„Éº„Çø„Çª„ÉÉ„Éà„Å´„Åä„ÅÑ„Å¶„ÄÅÊ±∫ÂÆöÂ¢ÉÁïå„ÇíÊ±Ç„ÇÅ„Çã„ÄÇ‰∏ªÂïèÈ°å„ÇíË®≠ÂÆö„Åó„ÄÅ„Åù„Åì„Åã„ÇâÂèåÂØæÂïèÈ°å„ÇíÊ±Ç„ÇÅ„Çã„ÄÇ„Åì„Çå„ÇíÂÖ∑‰ΩìÁöÑ„Å´Áú∫„ÇÅ„Çã„Åì„Å®„Åß„Å©„ÅÜ„ÅÑ„Å£„Åü„ÇÇ„ÅÆ„Åß„ÅÇ„Çã„Åã„ÇíÂ∞ë„Åó„Åß„ÇÇÊé¥„Çì„Åß„ÅÑ„Åè„ÄÇ

# „Éá„Éº„Çø„Çª„ÉÉ„Éà

3 „Éë„Çø„Éº„É≥ËÄÉ„Åà„Åü„Åå‰ª•‰∏ã„ÅÆ„ÇÇ„ÅÆ„ÅåÊïôËÇ≤ÁöÑË¶≥ÁÇπ„Åä„Çà„Å≥Ë®àÁÆó„ÅÆÊ•Ω„Åï„ÅÆË¶≥ÁÇπ„ÅßËâØ„Åï„Åù„ÅÜ„Å´ÊÑü„Åò„Åü„ÅÆ„Åß„Åì„Çå„ÇíÊâ±„ÅÜ„ÄÇ‰ªñ„ÅÆ„Ç±„Éº„Çπ„Åß„ÇÇÁµêÂ±Ä„ÅØ‰ºº„Åü„Çà„ÅÜ„Å™ÊÑü„Åò„Å´„ÅØ„Å™„Çã„ÅÆ„Å†„Åå„ÄÅÊâãË®àÁÆó„ÅßÁ¢∫Ë™ç„Åó„Åü„Å®„Åì„ÇçË®àÁÆó„ÅÆÁÖ©Èõë„Å™ÈÉ®ÂàÜ„ÅåÈÉΩÂ∫¶Â§â„Çè„Çä„ÄÅ„ÅÇ„Åæ„ÇäÊú¨Ë≥™ÁöÑ„Åß„ÅØ„Å™„ÅÑ„ÅÆ„Å´Ë®ò‰∫ã„ÅåÈï∑„Åè„Å™„Çã„ÅÆ„ÅßÊÄù„ÅÑÂàá„Å£„Å¶ÂïèÈ°åË®≠ÂÆö„Çí 1 Á®ÆÈ°û„Å´Áµû„Å£„Åü„ÄÇ

‰∏ãÂõ≥

![](/images/dwd-optimization02/001.png)

„ÅÆ„Çà„ÅÜ„Å´„ÄÅ„Éá„Éº„Çø„Çª„ÉÉ„Éà $\{ (\xi_1, t_1),(\xi_2, t_2),(\xi_3, t_3)\}$ „ÇíÁî®ÊÑè„Åô„Çã„ÄÇ$t_i \in \{-1, +1\}$ „Åß„ÅÇ„Çã„ÄÇ

# ‰∏ªÂïèÈ°å

Êö´„Åè PRML „ÅÆÈÄö„Çä„Å´Êõ∏„Åç‰∏ã„Åó„Å¶„ÅÑ„Åè„ÄÇ

$$
\begin{align*}
y(\mathbf{x}) &= \mathbf{w}^T \mathbf{x} + b = \braket{\mathbf{w}, \mathbf{x}} + b = w^1 x^1 + w^2 x^2 + b
\tag{1}
\end{align*}
$$

„ÅÆÂΩ¢„ÅßÊ±∫ÂÆöÂ¢ÉÁïå„ÇíÊ±Ç„ÇÅ„Åü„ÅÑ„ÄÇ$\operatorname{sgn}(y(\mathbf{x})) > 0$ „Å® $\operatorname{sgn}(y(\mathbf{x})) < 0$ „Å´„Çà„Å£„Å¶ 2 „Å§„ÅÆ„ÇØ„É©„Çπ„ÇíÂàÜÈ°û„Åô„Çã„Åì„Å®„Å´„Å™„Çã„ÄÇ

„Åæ„Å†„ÄÅÊ±∫ÂÆöÂ¢ÉÁïå„ÇíÂÆö„ÇÅ„Çã„Éë„É©„É°„Éº„ÇøÂÄ§„ÅåÊ±Ç„Åæ„Å£„Å¶„ÅÑ„Å™„ÅÑ„ÅÆ„Åß„ÄÅÂ¢ÉÁïå„ÅÆ‰ª£„Çè„Çä„Å´ ‚ÄúË∂ÖÂπ≥Èù¢‚Äù „Å®Âëº„Å∂„Åì„Å®„Å´„Åô„Çã[^1]„ÄÇ

[^1]: ‰ªäÂõû„ÅØÊôÆÈÄö„ÅÆÂπ≥Èù¢„Åß„ÅÇ„Çã„ÄÇ

Ë∂ÖÂπ≥Èù¢„Å∏„ÅÆ $\xi_i$ „Åã„Çâ„ÅÆË∑ùÈõ¢„ÅØ $|y(\xi_i)| / |\mathbf{w}|$ „Åß‰∏é„Åà„Çâ„Çå„Çã[^2]„ÄÇ„É©„Éô„É´ $t_i$ „ÅÆÁµ∂ÂØæÂÄ§„Çí 1 „Å´„Å®„Å£„Å¶„ÅÑ„Çã„Åì„Å®„Åã„Çâ„ÄÅ$|y(\xi_i)| = t_i y(\xi_i)$ „ÅåÊàêÁ´ã„Åô„Çã„Åì„Å®„Å´Ê≥®ÊÑè„Åô„Çã„ÄÇ„Åô„Çã„Å®„ÄÅ$\xi_i$ „Åã„Çâ„ÅÆË∂ÖÂπ≥Èù¢„Å∏„ÅÆË∑ùÈõ¢„ÅØ

[^2]: Ë∂ÖÂπ≥Èù¢„ÅÆÊ≥ïÁ∑öÊñπÂêë„ÅÆ„Éô„ÇØ„Éà„É´„ÅØ $\mathbf{w}$ „Åß„ÅÇ„Çã„ÅÆ„Åß„ÄÅ$\xi_i + \mathbf{w} t$ „ÅåË∂ÖÂπ≥Èù¢„Å´‰πó„Çã $t$ „ÇíÊ±Ç„ÇÅ„Çå„Å∞ËâØ„ÅÑ„ÄÇ„Åì„ÅÆÊôÇ„ÄÅ$|\mathbf{w} t| = |\mathbf{w}| |t|$ „ÅåË®àÁÆó„Åó„Åü„ÅÑË∑ùÈõ¢„Å´„Å™„Çã„ÄÇ$0 = y(\xi_i + \mathbf{w} t) = \mathbf{w}^T \xi_i + \mathbf{w}^T \mathbf{w} t + b = y(\xi_i) + |\mathbf{w}|^2 t$ „Å™„ÅÆ„Åß„ÄÅ$|\mathbf{w}| |t| = |y(\xi_i)| / |\mathbf{w}|$ „ÅåË∂ÖÂπ≥Èù¢„Å∏„ÅÆË∑ùÈõ¢„Å®„Å™„Çã„ÄÇ

$$
\begin{align*}
\frac{t_i y(\xi_i)}{|\mathbf{w}|} = \frac{t_i (\mathbf{w}^T \xi_i + b)}{|\mathbf{w}|}
\end{align*}
$$

„Å®„Å™„Çã„ÄÇ„Çµ„Éù„Éº„Éà„Éô„ÇØ„Çø„Éº„ÅØ„Åì„Çå„ÅåÊúÄÂ∞è„Å®„Å™„Çã„ÇÇ„ÅÆ„Åß„ÅÇ„Çã„ÅÆ„Åß„ÄÅ„Çµ„Éù„Éº„Éà„Éô„ÇØ„Çø„Éº„ÅÆÈï∑„Åï„ÅØ

$$
\begin{align*}
\min_i \frac{t_i (\mathbf{w}^T \xi_i + b)}{|\mathbf{w}|} = \frac{1}{|\mathbf{w}|} \min_i [t_i (\mathbf{w}^T \xi_i + b)]
\end{align*}
$$

„Å®„Å™„Çã„ÄÇ„Åì„ÅÆÂÄ§„ÄÅ„Å§„Åæ„Çä„Çµ„Éù„Éº„Éà„Éô„ÇØ„Çø„Éº„Å®Ë∂ÖÂπ≥Èù¢„Å∏„ÅÆË∑ùÈõ¢ ‚Äî „Éû„Éº„Ç∏„É≥ ‚Äî „ÇíÊúÄÂ§ßÂåñ„Åó„Åü„ÅÑ„Å®„ÅÑ„ÅÜ„Åì„Å®„Å™„ÅÆ„Åß„ÄÅMax-Min ÂïèÈ°å

$$
\begin{align*}
\mathbf{w}^*,b^* = \argmax_{\mathbf{w},b} \frac{1}{|\mathbf{w}|} \min_i [t_i (\mathbf{w}^T \xi_i + b)]
\end{align*}
$$

„ÇíËß£„Åè‰∫ã„ÅßÊ±∫ÂÆöÂ¢ÉÁïå„ÇíÂÆö„ÇÅ„Çã„Éë„É©„É°„Éº„Çø„ÅåÊ±Ç„Åæ„Çã„ÄÇ

$\mathbf{w} \to \kappa \mathbf{w}$, $b \to \kappa b$ „ÅÆ„Çπ„Ç±„Éº„É™„É≥„Ç∞„Åß $|y(\xi_i)| / |\mathbf{w}|$ „ÅØ‰∏çÂ§â„Å™„ÅÆ„Åß„ÄÅ$\kappa$ „ÇíË™øÊï¥„Åô„Çã„Åì„Å®„Åß„ÄÅ„ÄåË∂ÖÂπ≥Èù¢„Å´ÊúÄ„ÇÇËøë„ÅÑ $\xi_i$ „Å´„Å§„ÅÑ„Å¶„ÅØ $|y(\xi_i)| = t_i (\mathbf{w}^T \xi_i + b) = 1$ „Å®‰ªÆÂÆö„Äç„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Çã„ÄÇ„Åì„ÅÆÊôÇ„ÄÅ„Åô„Åπ„Å¶„ÅÆ„Éá„Éº„Çø„Å´„Å§„ÅÑ„Å¶ $t_i (\mathbf{w}^T \xi_i + b) \geq 1$ „Å®„Å™„Çã„ÄÇ

„Åì„ÅÆÁä∂Ê≥Å‰∏ã„ÅßÊÆã„Å£„Å¶„ÅÑ„ÇãË™≤È°å„ÅØ $\frac{1}{|\mathbf{w}|}$ „ÅÆÊúÄÂ§ßÂåñ„Åß„ÅÇ„Çã„Åå„ÄÅÂêåÂÄ§„Å™Êù°‰ª∂„Å®„Åó„Å¶ $\frac{1}{2} |\mathbf{w}|^2$ „ÅÆÊúÄÂ∞èÂåñ„ÅåËÄÉ„Åà„Çâ„Çå„Çã„ÄÇ„Åì„Åì„Åæ„Åß„Çí„Åæ„Å®„ÇÅ„Çã„Å®„ÄÅ**‰∏ªÂïèÈ°å**„Å®„Åó„Å¶„ÅÆÂá∏ÊúÄÈÅ©Âåñ„Åß„ÅÇ„Çã 2 Ê¨°Ë®àÁîªÂïèÈ°å

$$
\begin{align*}
\min \frac{1}{2} |\mathbf{w}|^2 \quad\text{subject to}\quad t_i (\mathbf{w}^T \xi_i + b) \geq 1
\tag{2}
\end{align*}
$$

„ÇíÂæó„Çã„ÄÇ

# ÂèåÂØæÂïèÈ°å

‰ªäÂõû„ÅØ‰∏ªÂïèÈ°å„ÅÆ„Åæ„Åæ„Åß„ÅØËß£„Åè„ÅÆ„ÅåÈõ£„Åó„ÅÑ„ÅÆ„ÅßÂèåÂØæÂïèÈ°å„Å®Âëº„Å∞„Çå„ÇãÂêåÂÄ§„Å™ÂïèÈ°å„ÇíÊ±Ç„ÇÅ„Å¶„Åù„Å°„Çâ„ÇíËß£„Åè„Åì„Å®„Å´„Åô„Çã„ÄÇÊñáÁåÆ [„Ç´„Éº„Éç„É´Ê≥ï] „Å´„Çà„Çã„Å®„ÄÅÂá∏ÊúÄÈÅ©ÂåñÂïèÈ°å„ÇíËß£„ÅèÈöõ„Å´„ÅØÂèåÂØæÂïèÈ°å„ÇíËÄÉ„Åà„Çã„Å®ÊúâÁî®„Å™„Åì„Å®„ÅåÂ§ö„ÅÑ„Çâ„Åó„ÅÑ„ÄÇ

„Åì„Åì„Åß„ÅØ PRML „ÅÆË®òÊ≥ï„Åù„ÅÆ„Åæ„Åæ„Åß„ÅØ„Å™„Åè„ÄÅLagrange „ÅÆÊú™ÂÆö‰πóÊï∞Ê≥ï„Åß„Çà„ÅèË¶ã„Åã„Åë„Çã $\lambda = \{ \lambda_i\} \subset \R_{\geq 0}$ „Çí Lagrange multiplier „Å®„Åó„Å¶Áî®„ÅÑ„Çã„ÄÇLagrange „ÅÆÊú™ÂÆö‰πóÊï∞Ê≥ï„ÅßË°å„Å£„Åü„Çà„ÅÜ„Å´„ÄÅÊúÄÈÅ©Âåñ„Åó„Åü„ÅÑÂºè„Å®ÊùüÁ∏õÊù°‰ª∂„Å´ Lagrange multiplier „ÇíÊéõ„Åë„ÅüÂºè„ÅÆÂíå„Å®„Åó„Å¶Ê¨°„ÅÆ Lagrange Èñ¢Êï∞„ÇíËÄÉ„Åà„Çã„ÄÇ

$$
\begin{align*}
L(\mathbf{w}, b, \lambda) = \frac{1}{2} |\mathbf{w}|^2 - \sum_i \lambda_i \{ t_i (\mathbf{w}^T \xi_i + b) - 1 \}
\tag{3}
\end{align*}
$$

Ê•µÂÄ§„Çí‰∏é„Åà„ÇãÁÇπ„ÇíÊ±Ç„ÇÅ„Çã„Åü„ÇÅ„Å´ $L$ „ÅÆÂæÆÂàÜ„Çí„Å®„Å£„Å¶ 0 „Å®ÁΩÆ„Åè; $\frac{\partial L}{\partial \mathbf{w}} = 0$ „Å® $\frac{\partial L}{\partial b} = 0$ „Åã„Çâ

$$
\begin{align*}
\mathbf{w} &= \sum_i \lambda_i t_i \xi_i \\
0 &= \sum_i \lambda_i t_i
\tag{4}
\end{align*}
$$

„ÇíÂæó„Çã„ÄÇ„Åì„Çå„Çâ„Çí (3) Âºè„Å´‰ª£ÂÖ•„Åô„Çã„Å® **$b$ „ÅÆ‰øÇÊï∞„ÅØ (4) „ÅÆÁ¨¨ 2 Âºè„Å´„Çà„Å£„Å¶Ê∂à„Åà„Çã**„ÅÆ„Åß„ÄÅ

$$
\begin{align*}
&\ \frac{1}{2} \sum_{j, k} (\lambda_j t_j \xi_j^T) (\lambda_k t_k \xi_k) - \sum_i \left[ \lambda_i t_i \{ (\sum_k \lambda_k t_k \xi_k^T) \xi_i + b \} - \lambda_i \right] \\
=&\ \sum_i \lambda_i - \frac{1}{2} \sum_{j, k} (\lambda_j t_j \xi_j^T) (\lambda_k t_k \xi_k)
\end{align*}
$$

„ÇíÂæó„Çã„ÄÇÊ∑ªÂ≠ó„ÇíÊï¥ÁêÜ„Åó„Å¶ÊúÄÂæå„ÅÆÂºè„Çí $\tilde{L}(\lambda)$ „Å®ÁΩÆ„Åè:

$$
\begin{align*}
\tilde{L}(\lambda) = \sum_i \lambda_i - \frac{1}{2} \sum_{i, j} \lambda_i \lambda_j t_i t_j \xi_i^T \xi_j
\end{align*}
$$

„Åì„ÅÆ $\tilde{L}(\lambda)$ „ÇíÁî®„ÅÑ„ÅüÊ¨°„ÅÆÂïèÈ°å„Çí**ÂèåÂØæÂïèÈ°å**„Å®Âëº„Å∂:

$$
\begin{align*}
\max \tilde{L}(\lambda) \quad\text{subject to}\quad \lambda_i \geq 0,\ i = 1,2,\cdots
\tag{5}
\end{align*}
$$

„Éª„Éª„Éª

## „Åì„Åì„ÅßÊÄù„ÅÑ„Å£„Åç„ÇäÁúÅÁï•„Åô„Çã

‰ΩïÊïÖÊÄ•„Å´ $\tilde{L}(\lambda)$ „ÇíÊúÄÂ§ßÂåñ„Åô„ÇãË©±„ÅåÂá∫„Å¶„Åè„Çã„ÅÆ„ÅãÂàÜ„Çä„Å´„Åè„ÅÑ„ÅÆ„Å†„Åå„ÄÅ**Âº∑ÂèåÂØæÊÄß**„Å®„ÅÑ„ÅÜÊ¶ÇÂøµ„ÇíÁî®„ÅÑ„Çã„Åü„ÇÅ„Å´„Åù„ÅÜ„ÅÑ„ÅÜ„Åì„Å®„Å´„Å™„Çã„Çâ„Åó„ÅÑ„ÄÅ„Å®„ÅÑ„ÅÜ„ÅÆ„ÅåÁèæÊôÇÁÇπ„Åß„ÅÆÁêÜËß£„Åß„ÅÇ„Çã„ÄÇ„Å§„Åæ„Çä:

ÊñáÁåÆ [„Ç´„Éº„Éç„É´Ê≥ï] pp.212-215 Ëæ∫„Çä„ÇíË™≠„ÇÄ„Åì„Å®„Åß„ÄÅ‰∏ªÂïèÈ°å„ÅåÂá∏ÊúÄÈÅ©Âåñ„Åß„ÅÇ„Çä„ÄÅSlater Êù°‰ª∂„ÇíÊ∫Ä„Åü„Åô[^3]„Åì„Å®„Åã„ÇâÂº∑ÂèåÂØæÊÄß„ÅåÊàêÁ´ã„Åó„ÄÅ‰∏ªÂïèÈ°å„ÅÆÊúÄÈÅ©ÂÄ§ $p^*$ „Å®ÂèåÂØæÂïèÈ°å„ÅÆÊúÄÈÅ©ÂÄ§ $d^*$ „ÅØ‰∏ÄËá¥„Åó„ÄÅ„Åæ„Åü„ÅÇ„Çã $\lambda^* (= \argmax_\lambda \tilde{L}(\lambda))$ „Å´ÂØæ„Åó„Å¶ $\tilde{L}(\lambda^*)$ „Å®Á≠â„Åó„ÅÑ„Åì„Å®„ÅåÂàÜ„Åã„Çã„ÄÇ

[^3]: ÁÑ°Ëå∂Ëã¶Ëå∂„Å™„Éá„Éº„Çø„Çª„ÉÉ„Éà„Åß„ÅÇ„Çå„Å∞Ê∫Ä„Åü„Åï„Å™„ÅÑ„Åã„ÇÇ„Åó„Çå„Å™„ÅÑ„Åå„ÄÅ‰ªäÂõûËÄÉ„Åà„Å¶„ÅÑ„Çã 3 ÁÇπ„Éá„Éº„Çø„Çª„ÉÉ„Éà„Åß„ÅØÁ¥îÂàÜ„Å´ÂàÜÈõ¢ÊÄß„Åå„ÅÇ„ÇäÊù°‰ª∂„ÇíÊ∫Ä„Åü„Åô„ÄÇ

Ë¶Å„Åô„Çã„Å´„ÄÅ**‰ªäÂõû„ÅÆ„Ç±„Éº„Çπ„Åß„ÅØÂèåÂØæÂïèÈ°å„ÇíËß£„ÅÑ„Å¶ $\lambda^* = \{ \lambda^*_i \}$ „ÇíÊ±Ç„ÇÅ„Çå„Å∞ËâØ„ÅÑ„ÄÇ** „Åì„ÅÆ„Çà„ÅÜ„Å´„Åó„Å¶ $\lambda^* = \{ \lambda^*_i \}$ „ÅåÊ±Ç„Åæ„Çå„Å∞„ÄÅ(4) „ÅÆÁ¨¨ 1 Âºè„Å´‰ª£ÂÖ•„Åó„Å¶ $\mathbf{w}$ „ÇíÂÆö„ÇÅ„ÄÅ„Åù„ÅÆ $\mathbf{w}$ „Çí (1) Âºè„Å´‰ª£ÂÖ•„Åô„Çã„Å®„ÄÅÊ±∫ÂÆöÂ¢ÉÁïå„ÅØ

$$
y(\mathbf{x}) = (\sum_i \lambda^*_i t_i \xi_i^T) \mathbf{x} + b = \sum_i \lambda^*_i t_i \braket{\xi_i, \mathbf{x}} + b
\tag{6}
$$

„ÅßÂÆö„Åæ„Çã„Åì„Å®„Å´„Å™„Çã„ÄÇ

ÂèåÂØæÂïèÈ°å„ÇíÂ∞é„ÅèÈÅéÁ®ã„Åß $b$ „ÅØÊ∂à„Åà„Å¶„ÅÑ„Åü„ÅÆ„Åß„ÄÅ$\lambda^*$ „Åã„Çâ„ÅØÊ±∫ÂÆöÂ¢ÉÁïå„ÅÆÊ≥ïÁ∑ö„Éô„ÇØ„Éà„É´„Åó„ÅãÊ±Ç„Åæ„Çâ„Å™„ÅÑ„ÄÇ$b$ „ÅÆÂÄ§„ÅØ„ÄåË∂ÖÂπ≥Èù¢„Å´ÊúÄ„ÇÇËøë„ÅÑ $\xi_i$ „Å´„Å§„ÅÑ„Å¶„ÅØ $|y(\xi_i)| = t_i (\mathbf{w}^T \xi_i + b) = 1$ „Å®‰ªÆÂÆö„Äç„Åó„Å¶„ÅÑ„Åü„Åì„Å®„Åã„ÇâÂÆö„ÇÅ„Çã„Åì„Å®„Å´„Å™„Çã„ÄÇ

# ‰æãÈ°å

ÂÜíÈ†≠„ÅÆ 3 ÁÇπ„Éá„Éº„Çø„Çª„ÉÉ„Éà„Å´ÂØæ„Åó„Å¶Ê±∫ÂÆöÂ¢ÉÁïå„ÇíÊ±Ç„ÇÅ„Çã„ÄÇ

(4) Âºè„ÇíÂÖ∑‰ΩìÁöÑ„Å´Êõ∏„Åè„Å®:

$$
\begin{align*}
\mathbf{w} &= \begin{pmatrix}
2 \lambda_1 - 3 \lambda_2 \\
\lambda_1 + \lambda_2 + \lambda_3
\end{pmatrix}, \\
0 &= \lambda_1 - \lambda_2 + \lambda_3
\end{align*}
$$

„Åæ„Åü„ÄÅÂêÑ„Éá„Éº„ÇøÂêåÂ£´„ÅÆÂÜÖÁ©ç„ÇíÊ±Ç„ÇÅ„Å¶„Åä„Åè„Å®:

$\braket{\xi_1, \xi_1} = 5$, $\braket{\xi_2, \xi_2} = 10$, $\braket{\xi_3, \xi_3} = 1$, $\braket{\xi_1, \xi_2} = 5$, $\braket{\xi_2, \xi_3} = -1$, $\braket{\xi_3, \xi_1} = 1$

„Åß„ÅÇ„Çã„ÄÇ„Çà„Å£„Å¶„ÄÅ

$$
\begin{align*}
\tilde{L}(\lambda) &= \lambda_1 + \lambda_2 + \lambda_3 - \frac{1}{2}(-10 \lambda_1 \lambda_2 + 2 \lambda_2 \lambda_3 + 2 \lambda_3 \lambda_1 + 5 \lambda_1^2 + 10 \lambda_2^2 + \lambda_3^2) \\
&= \cdots \\
&= - \frac{13}{2} \left( \lambda_2 -\frac{2}{13} (1 + 3 \lambda_1) \right)^2 - \frac{8}{13} (\lambda_1 - \frac{3}{4})^2 + \frac{1}{2} \leq \frac{1}{2}
\end{align*}
$$

„ÇíÂæó„Çã„ÄÇ„Åì„Çå„ÇíÊúÄÂ§ßÂåñ„Åô„Çã„ÄÇËÄÉ„Åà„Çâ„Çå„ÇãÊúÄÂ§ßÂÄ§„ÅØ $\frac{1}{2}$ „Åß„ÅÇ„Çã„ÄÇ

„Åæ„ÅöÂè≥Ëæ∫Á¨¨ 2 È†Ö„Å´„Å§„ÅÑ„Å¶ $\lambda_1 = \frac{3}{4}$ „ÅåÂÄôË£ú„Åß„ÅÇ„Çã„ÄÇ„Åì„ÅÆÊôÇ„ÄÅÂè≥Ëæ∫Á¨¨ 1 È†Ö„Çí 0 „Å®ÁΩÆ„Åè„Å®„ÄÅ$\lambda_2 = \frac{1}{2}$ „ÅåÊ±Ç„Åæ„Çã„ÄÇ„Å®„Åì„Çç„Åå„ÄÅ$\lambda_3 = \lambda_2 - \lambda_1 = \frac{1}{2} - \frac{3}{4} = - \frac{1}{4} < 0$ „Å®„Å™„Çä**Âà∂Á¥ÑÊù°‰ª∂„Å´Âèç„Åô„Çã**„ÄÇ„Çà„Å£„Å¶„ÄÅÂçòÁ¥î„Å´„ÅØÊúÄÈÅ©Ëß£„ÅåÊ±Ç„Åæ„Çâ„Å™„ÅÑ„Åì„Å®„ÅåÂàÜ„Åã„Çã„ÄÇ

ÁµêÂ±Ä„ÅØ„ÄÅË®àÁÆó„ÅØÂ∞ë„ÄÖÈù¢ÂÄíËá≠„ÅÑ„ÅåÁ∂≤Êéõ„Åë„ÅÆÈÉ®ÂàÜ„ÅßËß£„ÇíÊ±Ç„ÇÅ„ÇãÂΩ¢„Å´„Å™„Çä„ÄÅ$- \frac{13}{2} \left( x -\frac{2}{13} (1 + 3 x) \right)^2 - \frac{8}{13} (x - \frac{3}{4})^2$ „ÇíÊúÄÂ§ßÂåñ„Åô„ÇãÂΩ¢„Åß $x = \frac{2}{5}$„ÄÅ**„Å§„Åæ„Çä„ÄÅ$\lambda_1 = \lambda_2 = \frac{2}{5}$, $\lambda_3 = 0$ „ÅåÊúÄÈÅ©Ëß£**„Åß„ÅÇ„Çã„Åì„Å®„ÅåÂàÜ„Åã„Çã„ÄÇ

![](/images/dwd-optimization02/002.png)

„Åì„ÅÆÊôÇ„ÄÅÊ±∫ÂÆöÂ¢ÉÁïå„ÅØ (6) Âºè„Çà„Çä

$$
\begin{align*}
y(\mathbf{x}) &= \frac{2}{5} \braket{\mathbf{x}, \xi_1} - \frac{2}{5} \braket{\mathbf{x}, \xi_2} + b \\
&= \frac{2}{5} (2 x^1 + x^2) - \frac{2}{5} (3 x^1 - x^2) + b \\
&= - \frac{2}{5} x^1 + \frac{4}{5} x^2 + b
\end{align*}
$$

„Å®„Å™„Çã„ÄÇ„ÄåË∂ÖÂπ≥Èù¢„Å´ÊúÄ„ÇÇËøë„ÅÑ $\xi_i$ „Å´„Å§„ÅÑ„Å¶„ÅØ $|y(\xi_i)| = t_i (\mathbf{w}^T \xi_i + b) = 1$ „Å®‰ªÆÂÆö„Äç„Åã„Çâ $b$ „ÇíÂÆö„ÇÅ„Çã„Å®„ÄÅ$b = 1$ „Å®„Å™„Çã„ÄÇ„Çà„Å£„Å¶„ÄÅÊúÄÁµÇÁöÑ„Å™Ê±∫ÂÆöÂ¢ÉÁïå„ÅØ

$$
\begin{align*}
y(\mathbf{x}) &= \frac{2}{5} \braket{\mathbf{x}, \xi_1} - \frac{2}{5} \braket{\mathbf{x}, \xi_2} + b \\
&= \frac{2}{5} (2 x^1 + x^2) - \frac{2}{5} (3 x^1 - x^2) + b \\
&= - \frac{2}{5} x^1 + \frac{4}{5} x^2 + 1
\end{align*}
$$

„Åß„ÅÇ„Çã„ÄÇ$y(\mathbf{x}) = 0$ „ÇíÂÜíÈ†≠„ÅÆÂõ≥„Å´Ëµ§Á∑ö„ÅßÁ§∫„Åó„Å¶„ÅÑ„Çã„ÄÇ

# Python „Åß„ÇÇÂÆüË£Ö„Åó„Å¶„Åø„Çã

ÊäòËßí„Å™„ÅÆ„Åß„ÄÅPython „Åß„ÅÆÂÆüË£Ö„ÇÇÁú∫„ÇÅ„Å¶„Åø„Çã„ÄÇscikit-learn „ÇíÁî®„ÅÑ„Çã„ÄÇ

```python
from sklearn.svm import LinearSVC

X = np.array([
    [2, 1],
    [3, -1],
    [0, 1],
])
y = np.array([1, -1, 1])

clf = LinearSVC(C=.1)
result = clf.fit(X, y)
```

„ÅÆ„Çà„ÅÜ„Å™ÂΩ¢„ÅßËâØ„ÅÑ„Å®ÊÄù„Çè„Çå„Çã„ÄÇÊ±∫ÂÆöÂ¢ÉÁïå„ÅÆÂèØË¶ñÂåñ„Åå„Çà„ÅèÂàÜ„Åã„Çâ„Å™„Åã„Å£„Åü„ÅÆ„Åß„ÄÅ[[Python]„Çµ„Éù„Éº„Éà„Éô„ÇØ„Éà„É´„Éû„Ç∑„É≥(SVM)„ÅÆÁêÜË´ñ„Å®ÂÆüË£Ö„ÇíÂæπÂ∫ïËß£Ë™¨„Åó„Å¶„Åø„Åü](https://qiita.com/renesisu727/items/964005bd29aa680ad82d) „ÇíÂèÇËÄÉ„Å´„Åï„Åõ„Å¶„ÅÑ„Åü„Å†„ÅÑ„Åü„ÄÇ

```python
import mglearn

mglearn.plots.plot_2d_separator(result, X, fill=False)
mglearn.discrete_scatter(X[:, 0], X[:, 1], y)

plt.xlabel(r'$x_1$')
plt.ylabel(r'$x_2$')

plt.show()
```

„Å°„Çá„Å£„Å®ÂÜÖÈÉ®„Åß‰Ωø„Å£„Å¶„ÅÑ„ÇãÂºè„ÅåÈÅï„ÅÑ„Åù„ÅÜ„Å™Ê∞ó„ÇÇ„Åó„Å¶‰ª•‰∏ã„ÅÆ„Çà„ÅÜ„Å™Ê±∫ÂÆöÂ¢ÉÁïå„ÅåÊèè„Åã„Çå„Åü„Åå„ÄÅÊú¨Ë≥™ÁöÑ„Å´„ÅØ‰ªäÂõûË®àÁÆó„Åó„ÅüÂÜÖÂÆπ„Å®Â§ßÂ∑Æ„ÅØ„Å™„ÅÑ„Å®ÊÄù„ÅÜ„ÄÇ„Åù„ÅÜ‰ø°„Åò„Åü„ÅÑ[^4]„ÄÇ

![](/images/dwd-optimization02/003.png)

# „Åæ„Å®„ÇÅ

„Åß„Åç„Çã„Å†„ÅëÁ∞°Âçò„Å™„Éá„Éº„Çø„Çª„ÉÉ„Éà„Å´ÂØæ„Åó„Å¶ÊâãË®àÁÆó„Åß SVM „ÅÆÊ±∫ÂÆöÂ¢ÉÁïå„ÇíÊ±Ç„ÇÅ„Å¶„Åø„Åü„ÄÇ„Åì„Çì„Å™Â∞è„Åï„Å™„Éá„Éº„Çø„Çª„ÉÉ„Éà„Å´ÂØæ„Åó„Å¶„ÇÇË®àÁÆó„ÅØ„Å®„Å¶„ÇÇÂ§ßÂ§â„Åß„ÅÇ„Çä„ÄÅ„Å®„Å¶„ÇÇ„Åß„ÅØ„Å™„ÅÑ„ÅåÊâãË®àÁÆó„ÅßÁèæÂÆüÁöÑ„Å™ÂïèÈ°å„ÇíËß£„Åë„Å™„ÅÑ„Åì„Å®„ÅåÂàÜ„Åã„Çã„ÄÇ„Çà„Å£„Å¶„ÄÅÈÄöÂ∏∏„ÅØ‰ªä„Åæ„ÅßÈÄö„Çä API „ÅßÁâá‰ªò„Åë„Çã„Åì„Å®„Å´„Å™„Çã„Åå„ÄÅËÉåÊôØ„Å´„ÅØ„Åì„ÅÜ„ÅÑ„ÅÜËÄÉ„Åà„Åå„ÅÇ„Çã„Åì„Å®„ÇíÁü•„Å£„Å¶„Åä„Åè„ÅÆ„ÅØÊÇ™„Åè„Å™„ÅÑ„Å®ÊÄù„ÅÜ„ÄÇ

[^4]: ÊâãË®àÁÆó„Å™„ÅÆ„Åß„ÄÅÂãøË´ñË®àÁÆó„ÇíÈñìÈÅï„Åà„Å¶„ÅÑ„ÇãÂèØËÉΩÊÄß„ÅØÂ§ß„ÅÑ„Å´„ÅÇ„Çã„ÄÇ

# ÊñáÁåÆ

- [PRML] C. M. Bishop, [Pattern Recognition and Machine Learning](https://www.microsoft.com/en-us/research/publication/pattern-recognition-machine-learning/), pp.325-331, Springer, 2006
- [„Ç´„Éº„Éç„É´Ê≥ï] Á¶èÊ∞¥ÂÅ•Ê¨°, „Ç´„Éº„Éç„É´Ê≥ïÂÖ•ÈñÄ, ÊúùÂÄâÊõ∏Â∫ó, 2010
