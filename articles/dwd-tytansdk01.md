---
title: "TYTAN SDK で遊んでみる (1) — ピタゴラス数"
emoji: "🪐"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["poem", "Python", "qubo"]
published: false
---

# 目的

言い回しは適切ではないかもしれないが、QUBO (Quadratic Unconstrained Binary Optimization) という概念があって、これをソルバで最適化して組合せ最適化問題を解きたい、ということがある (らしい)。

今回、この QUBO の最適化を通じた組合せ最適化について、基本的なところを押さえておきたいという理由でつらつらと記事を書いてみようかと思って、初回の記事を書いてみることにした。

# はじめに

QUBO による組合せ最適化が何かということは後に回すとして、そういったことができるものに、[D-Wave Ocean SDK](https://docs.ocean.dwavesys.com/en/stable/) とか [PyQUBO](https://pyqubo.readthedocs.io/en/latest/) とかいうものがあるらしい。たぶんそれらと似たようなものに [TYTAN SDK](https://www.tytansdk.com/) というのがあって、今回これを使ってみたい。まったく詳しくないので、たまたま目にとまって、なおかつチュートリアルが用意されていて何となく良さそうというくらいの動機である。なお、D-Wave の実機を除いては、恐らく「擬似量子アニーリング」という手法になると思う。

やることはシンプルで、解きたい組み合わせ問題を QUBO 式という式で記述してやって、ソルバに放り込めば、記述が妥当であってなおかつ運が良ければ最適解や準最適解が得られるというものになる。

# 簡単な例

QUBO は適当な変数を使って問題を解くのだが、Binary (二値) というだけあって、変数 $q_0$, $q_1$, ... は 0 か 1 の 2 値しかとれない。なおかつ、この変数について使える式の次数は Quadratic (二次) というだけあって、2 次式までである。つまり、$q_0^2$ は OK だが、$q_0^3$ や $q_0^4$ は NG である。この厳しい条件下で、足したら 2 になる数値を求めてみたい。つまり、解きたい問題は、$q_0, q_1 \in \{0, 1\}$ に対して

$$
\begin{align*}
q_0 + q_1 = 2
\tag{1}
\end{align*}
$$

である。大変自明ではあるのだが、脳内では一瞬で

- $q_0=0, q_1=0$
- $q_0=0, q_1=1$
- $q_0=1, q_1=0$
- $q_0=1, q_1=1$

を試しているはずである。ということにする[^1]。

[^1]: 生物学は知らないのでよく分からない。

なんと、4 回も計算するのは面倒くさいので、やりたくない。PC にお任せしたいというのがこういった問題をソルバで解きたい動機であろう。

ところで、いわゆる最適化問題として解くので何かしら損失関数的なものを用意してあげる必要がある。今回のケースであれば 2 つの損失関数 $L_1$ と $L_2$ が考えられそうである。

$$
\begin{align*}
L_1(q_0, q_1) = 2 - (q_0 + q_1)
\tag{2}
\end{align*}
$$

と

$$
\begin{align*}
L_2(q_0, q_1) = (q_0 + q_1 - 2)^2
\tag{3}
\end{align*}
$$

である。(2) 式は実は案に答えの当たりがついていないとこの形 (特に符号) にはできないので嫌な感じである。(3) 式は何も考えずに設計できて、頭を使わない。
